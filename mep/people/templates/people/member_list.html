{% extends 'base.html' %}
{% load static humanize widget_tweaks %}
{% load render_bundle from webpack_loader %}

{% block css %}{% render_bundle 'search' 'css' %}{% endblock %}

{% block js %}{% render_bundle 'search' 'js' attrs='defer' %}{% endblock %}

{% block page-subtitle %}Library Members Â· {% endblock %}

{% block header %}
{% include 'snippets/header.html' with title="members" style="search" %}
{% endblock %}

{% block main-style %}white{% endblock %}

{% block content %}
<section class="members search-form">
    <form id="members-form">
        <label class="query">
            {% render_field form.query aria-label=form.query.label %}
        </label>
        <fieldset>
                <legend>Filter by:</legend>
                <div class="toggle-filters">
                    {% render_field form.has_card aria-label=form.has_card.label class+="sr-only" tabindex=0 %}
                    <label for="id_has_card">
                        {# Wrapping attribute in <span> for CSS targeting #}
                        <span>Card <span class="count">{{ members.get_facets.has_card_b.true }}</span></span>
                        <img class="filter icon" src="{% static 'img/icons/member_card.svg' %}" alt="card icon">
                        <div class="info-img tooltip" role="img" aria-label="This filter will narrow results to show only members whose library records are available." tabindex=0>
                            <div class="tooltip__text">
                               <div class="arrow"></div>
                                This filter will narrow results to show only members whose library records are available.
                            </div>
                        </div>
                    </label>
                </div>
        </fieldset>
        <output class="total-results">{{ members.count|intcomma }} total result{{ members.count|pluralize }}</output>
    </form>
</section>
<section class="members sort-pages">
    <div class="inner">
        <label class="sort">
            <span>SORTED BY</span>
            {% render_field form.sort form="members-form" %}
            <img class="dropdown icon" src="{% static 'img/icons/chevron_down.png' %}" alt="">
        </label>
        <button type="submit" form="members-form">Go</button>
        {% include 'snippets/pagination.html' with form="members-form" %}
    </div>
    {% if page_obj.has_other_pages %} {# if only one page of results, don't show next/previous links #}
    <div class="outer">
        {% include 'snippets/page-controls.html' %}
    </div>
    {% endif %}
</section>
<ol class="members results-list" style="counter-reset: results {{ page_obj.start_index|add:'-1' }};">
    {% for person in members %}
        {% include 'people/snippets/member_result.html' with member=person %}
    {% endfor %}
</ol>
{% endblock %}